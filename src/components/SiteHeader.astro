---
import { withBasePath } from "../lib/site";

interface Props {
  currentPath?: string;
}

const { currentPath = "/" } = Astro.props;
const normalizedPath = currentPath.replace(/\/+$/, "") || "/";

const navItems = [
  { href: "/writing", label: "Writing" },
  { href: "/now", label: "Now" },
  { href: "/about", label: "About" }
];

function isActive(href: string): boolean {
  const normalizedHref = href.replace(/\/+$/, "") || "/";
  return normalizedPath === normalizedHref || normalizedPath.startsWith(`${normalizedHref}/`);
}
---

<header class="flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between sm:gap-8">
  <a href={withBasePath("/")} class="text-[1.05rem] font-medium tracking-tight hover:underline">Luca Poli</a>

  <nav aria-label="Main navigation" class="flex flex-wrap items-center gap-x-4 gap-y-2 text-[0.96rem] text-text sm:gap-6 sm:text-[0.98rem]">
    {
      navItems.map((item) => {
        const active = isActive(item.href);

        return (
          <a
            href={withBasePath(item.href)}
            class:list={["nav-link", active && "nav-link-active"]}
            aria-current={active ? "page" : undefined}
          >
            {item.label}
          </a>
        );
      })
    }
  </nav>
</header>
